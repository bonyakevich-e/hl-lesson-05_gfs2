{
  "version": 4,
  "terraform_version": "1.10.0",
  "serial": 348,
  "lineage": "fa996b78-e459-8645-f689-7dd8ecb5981d",
  "outputs": {
    "external_ip_address_nginx": {
      "value": "158.160.17.207",
      "type": "string"
    },
    "internal_ip_address_nginx0": {
      "value": "10.16.0.32",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "yandex_compute_image",
      "name": "ubuntu2404",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "created_at": "2024-11-25T10:59:40Z",
            "description": "Ubuntu 24.04 OsLogin",
            "family": "ubuntu-2404-lts-oslogin",
            "folder_id": "standard-images",
            "hardware_generation": [
              {
                "generation2_features": [],
                "legacy_features": [
                  {
                    "pci_topology": "PCI_TOPOLOGY_V1"
                  }
                ]
              }
            ],
            "id": "fd8chrq89mmk8tqm85r8",
            "image_id": "fd8chrq89mmk8tqm85r8",
            "labels": {},
            "min_disk_size": 10,
            "name": "ubuntu-2404-lts-oslogin-v20241125",
            "os_type": "linux",
            "pooled": true,
            "product_ids": [
              "f2et3djlqc2fl18gr8bs"
            ],
            "size": 5,
            "status": "ready"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "yandex_vpc_network",
      "name": "default",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "created_at": "2024-11-08T10:25:44Z",
            "default_security_group_id": "enph8nvndmf6tmo7urh2",
            "description": "Auto-created network",
            "folder_id": "b1ghnhdkga964vm8vfu6",
            "id": "enp014etv9tm4bcju6bq",
            "labels": {},
            "name": "default",
            "network_id": "enp014etv9tm4bcju6bq",
            "subnet_ids": [
              "e2lsbglh7iq9u6kfhn3o",
              "e9bri13lics7pf0i9vbq",
              "fl8c28ftrf5g7mdfkhl7"
            ]
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "local_file",
      "name": "init_yml",
      "provider": "provider[\"registry.terraform.io/hashicorp/local\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "content": "---\n- hosts: all\n  remote_user: ubuntu\n  become: yes\n  gather_facts: no\n  tasks:\n\n  - name: Wait for system to become reachable\n    ansible.builtin.wait_for_connection:\n\n  - name: Gather facts manually\n    ansible.builtin.setup:\n  \n  - name: Set timezone\n    timezone:\n      name: Europe/Moscow\n  \n  - name: Add entries to hosts\n    copy:\n      dest: /etc/hosts\n      content: \"#\\n\n127.0.0.1\tlocalhost\\n\n10.16.0.8\tmycluster1\\n\n10.16.0.30\tmycluster2\\n\n10.16.0.25\tmycluster3\\n\n10.16.0.32\tiscsi\\n\n\"\n\n- hosts: iscsi\n  remote_user: ubuntu\n  become: yes\n  tasks:\n \n  - name: Install targetcli-fb\n    apt:\n      name: targetcli-fb\n      state: present\n# настраиваем iscsi target с помощью сгенерированного скрипта   \n  - name: Configure target using bash script\n    script: iscsi_target.bash\n\n- hosts: cluster\n  remote_user: ubuntu\n  become: yes\n  vars:\n  - iqn_base: iqn.2024-05.otus-hl\n  tasks:\n  \n  - name: Install packages\n    apt:\n      name: \"{{ item }}\"\n      state: latest\n    with_items:\n    - pacemaker\n    - pcs\n    - gfs2-utils\n    - open-iscsi\n    - lvm2\n    - dlm-controld\n    - lvm2-lockd\n    - resource-agents-extra\n    - resource-agents-common\n    - resource-agents-base\n    - watchdog \n    - pcp-zeroconf\n    - fence-agents-scsi\n\n# меняем iqn iscsi клиентов\n  - name: Change InitiatorName in initiatorname.iscsi\n    ansible.builtin.lineinfile:\n      path: /etc/iscsi/initiatorname.iscsi\n      regexp: '^InitiatorName='\n      line: InitiatorName=iqn.2024-05.otus-hl:mycluster.{{ inventory_hostname }}\n\n  - name: restart iscsid\n    service: \n      name: iscsid\n      state: restarted\n\n# подключаем iscsi диск на ноды\n  - name: Discover iscsi target\n    community.general.open_iscsi:\n      show_nodes: true\n      discover: true\n      portal: iscsi\n\n  - name: Connect to the target  \n    community.general.open_iscsi:\n      login: true\n      target: 'iqn.2024-05.otus-hl:storage.target00'\n\n# автозапуск и автоподключение iscsi диска при загрузке системы\n  - name: Start iscsi\n    service:\n      name: \"{{ item }}\"\n      state: started\n      enabled: yes\n    with_items:\n      - iscsi\n\n# по дефолту Pacemaker запускает свою службу под пользователем hacluster\n  - name: Set password for hacluster to '123'\n    user:\n      name: hacluster\n      password: $5$A55.Uz8o.y8MuGaf$w3axEzoOgSeGyJo3OE56a4Ki1ctGEWP1GMyU7tOVJu6\n\n#  - name: Start cluster services\n#    service:\n#      name: \"{{ item }}\"\n#      state: started\n#      enabled: yes\n#    with_items:\n#      - pcsd\n\n# настраиваем Corosync. Аутентифицируем ноды, которые будут составлять наш кластер\n#  - name: Set up corosync nodes\n#    run_once: true\n#    command:\n#      cmd: /sbin/pcs host auth -u hacluster -p 123 mycluster1 mycluster2 mycluster3 \n#      creates: /var/lib/pcsd/tokens\n\n# Настраиваем файл конфигурации кластера и синхронизируем конфигурацию с указанными узлами\n#  - name: Create cluster\n#    run_once: true\n#    command:\n#      cmd: pcs cluster setup mycluster --start --enable mycluster1 mycluster2 mycluster3 --force\n#      creates: /etc/corosync/corosync.conf\n\n# Отключаем STONIGHT, он же FENCING\n#  - name: Disable fencing\n#    run_once: true\n#    command: /sbin/pcs property set stonith-enabled=false\n\n# Если кворум не соблюдается, замораживаем кластер\n#  - name: Freeze a no-quorum policy\n#    run_once: true\n#    command: /sbin/pcs property set no-quorum-policy=freeze\n\n# Создаем ресурс dlm\n#  - name: Create dlm\n#    run_once: true\n#    command: /sbin/pcs resource create dlm ocf:pacemaker:controld op start timeout=90s interval=0 op stop timeout=100s interval=0\n#    register: result\n#    failed_when:\n#      - result.rc != 0 and \"already exists\" not in result.stderr\n\n# Создаем ресурс lvmlockd\n#  - name: Create clvmd\n#    run_once: true\n#    command: /sbin/pcs resource create lvmlockd ocf:heartbeat:lvmlockd op start timeout=90s interval=0 op stop timeout=100s interval=0\n#    register: result\n#    failed_when:\n#      - result.rc != 0 and \"already exists\" not in result.stderr\n\n# указываем порядок запуска ресурсов на нодах\n#  - name: Set order constraint\n#    run_once: true\n#    command: pcs constraint order start dlm then lvmlockd\n#    register: result\n#    failed_when:\n#    - result.rc != 0 and \"already exists\" not in result.stderr\n\n# указываем какие ресурсы размещать на одной ноде\n#  - name: Set colocation constraint\n#    run_once: true\n#    command: pcs constraint colocation add lvmlockd with dlm\n#    register: result\n#    failed_when:\n#    - result.rc != 0 and \"already exists\" not in result.stderr\n\n# создаем кластерный VG на iscsi диске\n#  - name: Create a PV and VG\n#    run_once: true\n#    community.general.lvg:\n#      pvs: /dev/sda\n#      vg: vg01\n#      vg_options: --shared\n\n# создаем LV на только что созданном кластерном VG\n#  - name: Create a LV\n#    run_once: true\n#    community.general.lvol:\n#      vg: vg01\n#      lv: lv01\n#      size: 100%VG\n\n# создаем кластерную файловую систему gfs2 на только что созданном LV\n#  - name: Create a FS\n#    run_once: true\n#    command: mkfs.gfs2 -j 3 -p lock_dlm -t mycluster:fs01 -O /dev/vg01/lv01\n#    register: result\n#    failed_when:\n#    - result.rc != 0\n#    - '\"Device or resource busy\" not in result.stderr'\n\n# Создаем ресурс clusterfs\n#  - name: Create a clusterfs resource\n#    run_once: true\n#    command: /sbin/pcs resource create clusterfs ocf:heartbeat:Filesystem device=/dev/vg01/lv01 directory=/mnt/gfs2 fstype=gfs2 options=noatime op monitor interval=10s on-fail=ignore clone interleave=true --wait\n#    register: result\n#    failed_when:\n#    - result.rc != 0\n#    - '\"already exists\" not in result.stderr'\n\n# указываем порядок запуска ресурсов на нодах\n#  - name: Set order constraint\n#    run_once: true\n#    command: pcs constraint order start clvmd-clone then clusterfs-clone\n#    register: result\n#    failed_when:\n#    - result.rc != 0\n#    - '\"already exists\" not in result.stderr'\n\n# указываем какие ресурсы размещать на одной ноде\n#  - name: Set colocation constraint\n#    run_once: true\n#    command: pcs constraint colocation add clusterfs-clone with clvmd-clone\n#    register: result\n#    failed_when:\n#    - result.rc != 0\n#    - '\"already exists\" not in result.stderr'\n\n# создаем файлы с именем ноды на расшаренном диске для демонстрации одновременного доступа\n#  - name: Put a test file\n#    shell:\n#      cmd: hostname \u003e\u003e hostnames\n#      chdir: /mnt/gfs2",
            "content_base64": null,
            "content_base64sha256": "ibzMhzwmcR+LBdo3lN1U8gtI+osrxptqifxoYrSf6OY=",
            "content_base64sha512": "EfOcsK7WCSt/hhFEo1tCe7qM/jDJ/yIZV+YY+7gAPFh9wIjTiYQb7+hRH9Ft5oXLxj+zvuNeSq+aAdPgVCGYaw==",
            "content_md5": "73cc7c7161c3fc18e2f32b00e2658ebd",
            "content_sha1": "1ce0979ff34311b70a281f700b9e2dcfcb0291df",
            "content_sha256": "89bccc873c26711f8b05da3794dd54f20b48fa8b2bc69b6a89fc6862b49fe8e6",
            "content_sha512": "11f39cb0aed6092b7f861144a35b427bba8cfe30c9ff221957e618fbb8003c587dc088d389841befe8511fd16de685cbc63fb3bee35e4aaf9a01d3e05421986b",
            "directory_permission": "0777",
            "file_permission": "0644",
            "filename": "./playbook.yml",
            "id": "1ce0979ff34311b70a281f700b9e2dcfcb0291df",
            "sensitive_content": null,
            "source": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "sensitive_content"
              }
            ]
          ],
          "dependencies": [
            "data.yandex_compute_image.ubuntu2404",
            "data.yandex_vpc_network.default",
            "yandex_compute_disk.shared_disk",
            "yandex_compute_instance.cluster_instances",
            "yandex_compute_instance.iscsi",
            "yandex_vpc_subnet.subnet01"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "local_file",
      "name": "inventory",
      "provider": "provider[\"registry.terraform.io/hashicorp/local\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "content": "[iscsi_group]\niscsi ansible_host=158.160.17.207 ansible_ssh_common_args='-o StrictHostKeyChecking=no'\n\n[cluster]\nmycluster1 ansible_host=51.250.20.248 ansible_ssh_common_args='-o StrictHostKeyChecking=no'\nmycluster2 ansible_host=51.250.106.20 ansible_ssh_common_args='-o StrictHostKeyChecking=no'\nmycluster3 ansible_host=84.201.164.3 ansible_ssh_common_args='-o StrictHostKeyChecking=no'\n",
            "content_base64": null,
            "content_base64sha256": "d6YgV+KlkKwG4v3ebmZRdu5rgNM4l6q6ryW3HS9U1cg=",
            "content_base64sha512": "aKWOC4J2XLrZOwOqj+0wuvZSqDqcmdYYrhHtudViW5n3mzJh29qQfoEoJXLlCgHB0PVRmXyfyIBfwezSiwF5oA==",
            "content_md5": "121843daaaed06f9dde79e8c7fc266c7",
            "content_sha1": "3286f793fd670ff4e74ea13389377ebe35b23cd5",
            "content_sha256": "77a62057e2a590ac06e2fdde6e665176ee6b80d33897aabaaf25b71d2f54d5c8",
            "content_sha512": "68a58e0b82765cbad93b03aa8fed30baf652a83a9c99d618ae11edb9d5625b99f79b3261dbda907e81282572e50a01c1d0f551997c9fc8805fc1ecd28b0179a0",
            "directory_permission": "0777",
            "file_permission": "0644",
            "filename": "./hosts",
            "id": "3286f793fd670ff4e74ea13389377ebe35b23cd5",
            "sensitive_content": null,
            "source": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "sensitive_content"
              }
            ]
          ],
          "dependencies": [
            "data.yandex_compute_image.ubuntu2404",
            "data.yandex_vpc_network.default",
            "yandex_compute_disk.shared_disk",
            "yandex_compute_instance.cluster_instances",
            "yandex_compute_instance.iscsi",
            "yandex_vpc_subnet.subnet01"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "local_file",
      "name": "setup_iscsi_target",
      "provider": "provider[\"registry.terraform.io/hashicorp/local\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "content": "#!/bin/bash\n\ntargetcli \u003c\u003c EOF\n\ncd /backstores/block\ncreate disk01 /dev/vdb\n\ncd /iscsi\ncreate iqn.2024-05.otus-hl:storage.target00\n\ncd /iscsi/iqn.2024-05.otus-hl:storage.target00/tpg1/luns\ncreate /backstores/block/disk01 lun=1\n\ncd ..\nset attribute authentication=0\n\ncd acls/\ncreate iqn.2024-05.otus-hl:mycluster.mycluster1\ncreate iqn.2024-05.otus-hl:mycluster.mycluster2\ncreate iqn.2024-05.otus-hl:mycluster.mycluster3\nEOF",
            "content_base64": null,
            "content_base64sha256": "v6F924ltxMI6zMJIF3YE+GP4qVGd7dPGSvUMMQso1BE=",
            "content_base64sha512": "ygUejZLOMB/sW30lgb/b/n1HpNuKRAfotkC1pt8gB8DsnsLtabA09JZ8Mea9fSvXIo5CTJprj+z33ocBiM/5lg==",
            "content_md5": "585fdc1ca8cd3a5f14c5f9a362bcd556",
            "content_sha1": "431936a2c9dd59a78724c688ba4693aa5a2cf2e3",
            "content_sha256": "bfa17ddb896dc4c23accc248177604f863f8a9519dedd3c64af50c310b28d411",
            "content_sha512": "ca051e8d92ce301fec5b7d2581bfdbfe7d47a4db8a4407e8b640b5a6df2007c0ec9ec2ed69b034f4967c31e6bd7d2bd7228e424c9a6b8fecf7de870188cff996",
            "directory_permission": "0777",
            "file_permission": "0644",
            "filename": "./iscsi_target.bash",
            "id": "431936a2c9dd59a78724c688ba4693aa5a2cf2e3",
            "sensitive_content": null,
            "source": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "sensitive_content"
              }
            ]
          ],
          "dependencies": [
            "data.yandex_compute_image.ubuntu2404",
            "data.yandex_vpc_network.default",
            "yandex_compute_instance.cluster_instances",
            "yandex_vpc_subnet.subnet01"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_compute_disk",
      "name": "shared_disk",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "allow_recreate": null,
            "block_size": 4096,
            "created_at": "2024-12-13T18:24:43Z",
            "description": "",
            "disk_placement_policy": [
              {
                "disk_placement_group_id": ""
              }
            ],
            "folder_id": "b1ghnhdkga964vm8vfu6",
            "hardware_generation": [
              {
                "generation2_features": [],
                "legacy_features": [
                  {
                    "pci_topology": "PCI_TOPOLOGY_V1"
                  }
                ]
              }
            ],
            "id": "epdocmd2n6g8pju746pc",
            "image_id": "",
            "labels": null,
            "name": "shared-disk",
            "product_ids": [],
            "size": 5,
            "snapshot_id": "",
            "status": "ready",
            "timeouts": null,
            "type": "network-hdd",
            "zone": "ru-central1-b"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH19"
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_compute_instance",
      "name": "cluster_instances",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "allow_recreate": null,
            "allow_stopping_for_update": null,
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "epdl3metqnlt7rtroivb",
                "disk_id": "epdl3metqnlt7rtroivb",
                "initialize_params": [
                  {
                    "block_size": 4096,
                    "description": "",
                    "image_id": "fd8chrq89mmk8tqm85r8",
                    "name": "boot-disk-mycluster1",
                    "size": 10,
                    "snapshot_id": "",
                    "type": "network-hdd"
                  }
                ],
                "mode": "READ_WRITE"
              }
            ],
            "created_at": "2024-12-13T18:24:43Z",
            "description": "",
            "filesystem": [],
            "folder_id": "b1ghnhdkga964vm8vfu6",
            "fqdn": "mycluster1.ru-central1.internal",
            "gpu_cluster_id": "",
            "hardware_generation": [
              {
                "generation2_features": [],
                "legacy_features": [
                  {
                    "pci_topology": "PCI_TOPOLOGY_V1"
                  }
                ]
              }
            ],
            "hostname": "mycluster1",
            "id": "epd6k4q6q4l2b8cevug0",
            "labels": null,
            "local_disk": [],
            "maintenance_grace_period": "",
            "maintenance_policy": null,
            "metadata": {
              "ssh-keys": "ubuntu:ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFsv6OblDNKcWCXVFwd7wFacShcXDYt/mqBrPConqp8f itbn@LearningMachine1\n"
            },
            "metadata_options": [
              {
                "aws_v1_http_endpoint": 1,
                "aws_v1_http_token": 2,
                "gce_http_endpoint": 1,
                "gce_http_token": 1
              }
            ],
            "name": "mycluster1",
            "network_acceleration_type": "standard",
            "network_interface": [
              {
                "dns_record": [],
                "index": 0,
                "ip_address": "10.16.0.8",
                "ipv4": true,
                "ipv6": false,
                "ipv6_address": "",
                "ipv6_dns_record": [],
                "mac_address": "d0:0d:6a:13:46:d1",
                "nat": true,
                "nat_dns_record": [],
                "nat_ip_address": "51.250.20.248",
                "nat_ip_version": "IPV4",
                "security_group_ids": [],
                "subnet_id": "e2lc1bca1d85p9gjj4sj"
              }
            ],
            "placement_policy": [
              {
                "host_affinity_rules": [],
                "placement_group_id": "",
                "placement_group_partition": 0
              }
            ],
            "platform_id": "standard-v1",
            "resources": [
              {
                "core_fraction": 100,
                "cores": 2,
                "gpus": 0,
                "memory": 2
              }
            ],
            "scheduling_policy": [
              {
                "preemptible": false
              }
            ],
            "secondary_disk": [],
            "service_account_id": "",
            "status": "running",
            "timeouts": null,
            "zone": "ru-central1-b"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "data.yandex_compute_image.ubuntu2404",
            "data.yandex_vpc_network.default",
            "yandex_vpc_subnet.subnet01"
          ]
        },
        {
          "index_key": 1,
          "schema_version": 1,
          "attributes": {
            "allow_recreate": null,
            "allow_stopping_for_update": null,
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "epdfufq48rvi6trg9ish",
                "disk_id": "epdfufq48rvi6trg9ish",
                "initialize_params": [
                  {
                    "block_size": 4096,
                    "description": "",
                    "image_id": "fd8chrq89mmk8tqm85r8",
                    "name": "boot-disk-mycluster2",
                    "size": 10,
                    "snapshot_id": "",
                    "type": "network-hdd"
                  }
                ],
                "mode": "READ_WRITE"
              }
            ],
            "created_at": "2024-12-13T18:24:43Z",
            "description": "",
            "filesystem": [],
            "folder_id": "b1ghnhdkga964vm8vfu6",
            "fqdn": "mycluster2.ru-central1.internal",
            "gpu_cluster_id": "",
            "hardware_generation": [
              {
                "generation2_features": [],
                "legacy_features": [
                  {
                    "pci_topology": "PCI_TOPOLOGY_V1"
                  }
                ]
              }
            ],
            "hostname": "mycluster2",
            "id": "epdul1f90j4dlc6a67vr",
            "labels": null,
            "local_disk": [],
            "maintenance_grace_period": "",
            "maintenance_policy": null,
            "metadata": {
              "ssh-keys": "ubuntu:ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFsv6OblDNKcWCXVFwd7wFacShcXDYt/mqBrPConqp8f itbn@LearningMachine1\n"
            },
            "metadata_options": [
              {
                "aws_v1_http_endpoint": 1,
                "aws_v1_http_token": 2,
                "gce_http_endpoint": 1,
                "gce_http_token": 1
              }
            ],
            "name": "mycluster2",
            "network_acceleration_type": "standard",
            "network_interface": [
              {
                "dns_record": [],
                "index": 0,
                "ip_address": "10.16.0.30",
                "ipv4": true,
                "ipv6": false,
                "ipv6_address": "",
                "ipv6_dns_record": [],
                "mac_address": "d0:0d:1e:a8:5e:90",
                "nat": true,
                "nat_dns_record": [],
                "nat_ip_address": "51.250.106.20",
                "nat_ip_version": "IPV4",
                "security_group_ids": [],
                "subnet_id": "e2lc1bca1d85p9gjj4sj"
              }
            ],
            "placement_policy": [
              {
                "host_affinity_rules": [],
                "placement_group_id": "",
                "placement_group_partition": 0
              }
            ],
            "platform_id": "standard-v1",
            "resources": [
              {
                "core_fraction": 100,
                "cores": 2,
                "gpus": 0,
                "memory": 2
              }
            ],
            "scheduling_policy": [
              {
                "preemptible": false
              }
            ],
            "secondary_disk": [],
            "service_account_id": "",
            "status": "running",
            "timeouts": null,
            "zone": "ru-central1-b"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "data.yandex_compute_image.ubuntu2404",
            "data.yandex_vpc_network.default",
            "yandex_vpc_subnet.subnet01"
          ]
        },
        {
          "index_key": 2,
          "schema_version": 1,
          "attributes": {
            "allow_recreate": null,
            "allow_stopping_for_update": null,
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "epdmuvavd4iefcsjduh2",
                "disk_id": "epdmuvavd4iefcsjduh2",
                "initialize_params": [
                  {
                    "block_size": 4096,
                    "description": "",
                    "image_id": "fd8chrq89mmk8tqm85r8",
                    "name": "boot-disk-mycluster3",
                    "size": 10,
                    "snapshot_id": "",
                    "type": "network-hdd"
                  }
                ],
                "mode": "READ_WRITE"
              }
            ],
            "created_at": "2024-12-13T18:24:43Z",
            "description": "",
            "filesystem": [],
            "folder_id": "b1ghnhdkga964vm8vfu6",
            "fqdn": "mycluster3.ru-central1.internal",
            "gpu_cluster_id": "",
            "hardware_generation": [
              {
                "generation2_features": [],
                "legacy_features": [
                  {
                    "pci_topology": "PCI_TOPOLOGY_V1"
                  }
                ]
              }
            ],
            "hostname": "mycluster3",
            "id": "epd8ibu6ofhcijs17uho",
            "labels": null,
            "local_disk": [],
            "maintenance_grace_period": "",
            "maintenance_policy": null,
            "metadata": {
              "ssh-keys": "ubuntu:ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFsv6OblDNKcWCXVFwd7wFacShcXDYt/mqBrPConqp8f itbn@LearningMachine1\n"
            },
            "metadata_options": [
              {
                "aws_v1_http_endpoint": 1,
                "aws_v1_http_token": 2,
                "gce_http_endpoint": 1,
                "gce_http_token": 1
              }
            ],
            "name": "mycluster3",
            "network_acceleration_type": "standard",
            "network_interface": [
              {
                "dns_record": [],
                "index": 0,
                "ip_address": "10.16.0.25",
                "ipv4": true,
                "ipv6": false,
                "ipv6_address": "",
                "ipv6_dns_record": [],
                "mac_address": "d0:0d:89:2f:c6:c3",
                "nat": true,
                "nat_dns_record": [],
                "nat_ip_address": "84.201.164.3",
                "nat_ip_version": "IPV4",
                "security_group_ids": [],
                "subnet_id": "e2lc1bca1d85p9gjj4sj"
              }
            ],
            "placement_policy": [
              {
                "host_affinity_rules": [],
                "placement_group_id": "",
                "placement_group_partition": 0
              }
            ],
            "platform_id": "standard-v1",
            "resources": [
              {
                "core_fraction": 100,
                "cores": 2,
                "gpus": 0,
                "memory": 2
              }
            ],
            "scheduling_policy": [
              {
                "preemptible": false
              }
            ],
            "secondary_disk": [],
            "service_account_id": "",
            "status": "running",
            "timeouts": null,
            "zone": "ru-central1-b"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "data.yandex_compute_image.ubuntu2404",
            "data.yandex_vpc_network.default",
            "yandex_vpc_subnet.subnet01"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_compute_instance",
      "name": "iscsi",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "allow_recreate": null,
            "allow_stopping_for_update": null,
            "boot_disk": [
              {
                "auto_delete": true,
                "device_name": "epdp3pijfa00c9a8rkte",
                "disk_id": "epdp3pijfa00c9a8rkte",
                "initialize_params": [
                  {
                    "block_size": 4096,
                    "description": "",
                    "image_id": "fd8chrq89mmk8tqm85r8",
                    "name": "boot-disk-iscsi",
                    "size": 10,
                    "snapshot_id": "",
                    "type": "network-hdd"
                  }
                ],
                "mode": "READ_WRITE"
              }
            ],
            "created_at": "2024-12-13T18:24:53Z",
            "description": "",
            "filesystem": [],
            "folder_id": "b1ghnhdkga964vm8vfu6",
            "fqdn": "iscsi.ru-central1.internal",
            "gpu_cluster_id": "",
            "hardware_generation": [
              {
                "generation2_features": [],
                "legacy_features": [
                  {
                    "pci_topology": "PCI_TOPOLOGY_V1"
                  }
                ]
              }
            ],
            "hostname": "iscsi",
            "id": "epducr4pbf4vrqne6d5d",
            "labels": null,
            "local_disk": [],
            "maintenance_grace_period": "",
            "maintenance_policy": null,
            "metadata": {
              "ssh-keys": "ubuntu:ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFsv6OblDNKcWCXVFwd7wFacShcXDYt/mqBrPConqp8f itbn@LearningMachine1\n"
            },
            "metadata_options": [
              {
                "aws_v1_http_endpoint": 1,
                "aws_v1_http_token": 2,
                "gce_http_endpoint": 1,
                "gce_http_token": 1
              }
            ],
            "name": "iscsi",
            "network_acceleration_type": "standard",
            "network_interface": [
              {
                "dns_record": [],
                "index": 0,
                "ip_address": "10.16.0.32",
                "ipv4": true,
                "ipv6": false,
                "ipv6_address": "",
                "ipv6_dns_record": [],
                "mac_address": "d0:0d:1e:66:c9:95",
                "nat": true,
                "nat_dns_record": [],
                "nat_ip_address": "158.160.17.207",
                "nat_ip_version": "IPV4",
                "security_group_ids": [],
                "subnet_id": "e2lc1bca1d85p9gjj4sj"
              }
            ],
            "placement_policy": [
              {
                "host_affinity_rules": [],
                "placement_group_id": "",
                "placement_group_partition": 0
              }
            ],
            "platform_id": "standard-v1",
            "resources": [
              {
                "core_fraction": 100,
                "cores": 2,
                "gpus": 0,
                "memory": 2
              }
            ],
            "scheduling_policy": [
              {
                "preemptible": false
              }
            ],
            "secondary_disk": [
              {
                "auto_delete": false,
                "device_name": "shared_disk",
                "disk_id": "epdocmd2n6g8pju746pc",
                "mode": "READ_WRITE"
              }
            ],
            "service_account_id": "",
            "status": "running",
            "timeouts": null,
            "zone": "ru-central1-b"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "data.yandex_compute_image.ubuntu2404",
            "data.yandex_vpc_network.default",
            "yandex_compute_disk.shared_disk",
            "yandex_vpc_subnet.subnet01"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_vpc_subnet",
      "name": "subnet01",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "created_at": "2024-12-13T18:24:42Z",
            "description": "",
            "dhcp_options": [],
            "folder_id": "b1ghnhdkga964vm8vfu6",
            "id": "e2lc1bca1d85p9gjj4sj",
            "labels": {},
            "name": "subnet01",
            "network_id": "enp014etv9tm4bcju6bq",
            "route_table_id": "",
            "timeouts": null,
            "v4_cidr_blocks": [
              "10.16.0.0/24"
            ],
            "v6_cidr_blocks": [],
            "zone": "ru-central1-b"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAsImRlbGV0ZSI6MTgwMDAwMDAwMDAwLCJ1cGRhdGUiOjE4MDAwMDAwMDAwMH19",
          "dependencies": [
            "data.yandex_vpc_network.default"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
